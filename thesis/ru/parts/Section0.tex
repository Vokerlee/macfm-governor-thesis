\section{Введение}
\label{sec:Section0} \index{Section0}

    Для улучшения производительности компьютерных систем, а также для уменьшения потребляемой
    этими системами энергии (т.е. затрачиваемой мощности), в различных операционных системах
    используют механизмы регулирования тактовых частот как центрального процессора (ЦП),
    так и прочих компонент (графический процессор, нейронный процессор, и т.д.). Такие механизмы
    оперируют с технологией DVFS (Dynamic Voltage-Frequency Scaling), которая позволяет изменять
    тактовую частоту электронной схемы (одновременно изменяя рабочее напряжения схемы).

    В операционной системе Linux (версии 6.1), представляющей собой монолитное ядро,
    частоты ядер процессора, как правило, меняются посредством использования драйвера
    \textit{cpufreq}, предоставляющего API (Application Programming Interface) для регистрации
    интерфейса регулирования тактовых частот ядер ЦП. За частоты прочих компонент системы отвечает
    драйвер-API \textit{devfreq} (например, регулирование частоты шины, соединяющей соседние
    уровни кешей, или регулирование частоты работы оперативной памяти).

    На данный момент Linux использует политики регулирования тактовых частот ядер ЦП, которые
    не учитывают сложную структуру взаимодействия ЦП с прочими компонентами компьютерной системы,
    работающими при тактовой частоте, отличной от ЦП: кеши высоких уровней (L3 кеш, системный кеш),
    оперативная память. В современных реалиях производительность ядер ЦП в основном ограничена
    производительностью компонент памяти (кеши, оперативная память), взаимодействующих с ЦП,
    поэтому текущие политики регулирования тактовых частот в Linux не применимы в общем случае.

    Отсутствие учёта компонент памяти при регулировании тактовых частот ядер ЦП является критичным
    при выполнении приложений реального времени, такие как компьютерные игры и мессенджеры, где
    выставление неподходящих тактовых частот приводит к заметному замедлению приложения (деградации
    производительности) и/или к повышенному энергопотреблению, что негативно сказывается на
    опыт пользователя.

    Для учёта влияния внепроцессорных компонент на производительность ЦП необходимо построение
    модели производительности ядер ЦП, которое вызывает трудностей:
    \begin{enumerate}
        \item Необходимо априорное знание структуры компьютерной системы, на которой запущена
        операционная система, например, количество уровней кешей, их внутреннее устройство.
        \item Необходимо знать подробные характеристики блоков ядра ЦП, их внутреннее устройство, для
        учёта их доли влияния на конечную производительность самого ядра в целом.
        \item Необходимо измерить характеристики внепроцессорных компонент системы,
        например, зависимость задержки памяти (латентность) от уровня её утилизации (уровень
        нагрузки её пропускной способности), для учёта их доли влияния на конечную
        производительность ядра ЦП.
        \item Такая информация, как утилизация оперативной памяти, или какие блоки ядра процессора
        были использованы за фиксированный интервал времени, получить во время работы операционной
        системы, как правило, невозможно, поэтому требуется обходить использование такой информации
        в модели.
    \end{enumerate}

    Архитектура ARM big.LITTLE представляет собой концепцию, в которой одновременно
    используются различные типы ядер процессора (герогенная архитектура): ЦП разделяется на
    кластеры, часть которых состоит из более энергоэффективных, но менее производительных ядер,
    а другая часть состоит из производительных ядер, потребляющих значительно большее
    количество энергии.

    В компьютерных системах, использующих архитектуру ARM big.LITTLE, которая доминирует на рынке
    мобильных платформ на сегодняшний день, параллельно с задачей регулирования тактовых частот
    процессорных ядер возникает задача выбора ядерного кластера в зависимости от требований и
    специфики выполняемой задачи, что так же требует создание модели производительности ядер ЦП,
    делая эту задачу наиболее актуальной.

    Для решения обозначенных задач удобно использовать симулятор компьютерных
    архитектур с открытым исходным кодом, например, Gem5, который и будет использоваться в
    данной работе. Gem5 эмулирует поведение компьютерной системы, подобной реальной системе,
    включая поведение ядер процессора, поведение оперативной памяти, и т.д. Среди большого числа
    поддерживаемых архитектур в данной работы будет использована ARM64 (к которой относится
    ARM big.LITTLE).

    Для возможности построения модели производительности ядер ЦП, а также для реализации политики
    регулирования частот в операционной системе Linux, запущенной в эмуляции Gem5, были реализованы:
    \begin{enumerate}
        \item \textit{cpufreq} драйвер под платформу эмулятора Gem5.
        \item Cбор статистики микроархитектурных событий в Gem5 (универсальных для любой архитектуры),
        относящихся к кешам, для возможности использования этой статистики в Linux
        через драйвер \textit{perf}.
    \end{enumerate}

    Дополнительно для общности реализован драйвер-интерфейс $devfreq$ для возможности регулирования
    тактовых частот прочих компонент системы (при их поддержке технологии DVFS).

    Реализации, выполненные в данной работе, откроют возможность сторонним разработчикам/исследователям
    собирать данные микроархитектурных событий, связанных с кешами, для различных тактовых частот
    ядер ЦП, позволяя им проводить собственные исследования в области производительности ЦП.

\newpage
